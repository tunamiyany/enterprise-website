# 开发指南

## 快速开始流程

### 第一次使用

1. **安装依赖**
   ```bash
   运行: 0_安装依赖.bat
   ```

2. **初始化数据库**
   ```bash
   运行: 1_初始化数据库.bat
   ```

3. **启动开发服务器**
   ```bash
   运行: 2_启动开发服务器.bat
   访问: http://localhost:3000
   ```

### 日常开发

- **启动开发**: `2_启动开发服务器.bat`
- **管理数据**: `3_打开数据库管理.bat`
- **查看日志**: 在命令行窗口查看实时日志

## 添加产品数据

### 方法1: 使用 Prisma Studio (推荐)

1. 运行 `3_打开数据库管理.bat`
2. 在浏览器中打开 http://localhost:5555
3. 选择对应的表 (Product, Category等)
4. 点击 "Add record" 添加数据
5. 填写表单并保存

### 方法2: 编写脚本

在 `prisma/seed.ts` 中编写种子数据:

```typescript
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  // 创建分类
  const category = await prisma.category.create({
    data: {
      nameZh: '热缩管',
      nameEn: 'Heat Shrink Tubing',
      slug: 'heat-shrink-tubing',
      order: 1,
    },
  });

  // 创建产品
  await prisma.product.create({
    data: {
      code: 'G5-001',
      nameZh: '通用型阻燃热缩管',
      nameEn: 'General Purpose Heat Shrink Tubing',
      category: category.slug,
      isNew: true,
      isFeatured: true,
    },
  });
}

main()
  .catch((e) => console.error(e))
  .finally(async () => {
    await prisma.$disconnect();
  });
```

## 创建新页面

### 1. 产品列表页

创建文件: `src/app/[locale]/products/page.tsx`

```tsx
import { useTranslations } from 'next-intl';
import { prisma } from '@/lib/prisma';

export default async function ProductsPage() {
  const products = await prisma.product.findMany({
    orderBy: { order: 'asc' },
  });

  return (
    <div>
      {/* 产品列表 */}
    </div>
  );
}
```

### 2. 产品详情页

创建文件: `src/app/[locale]/products/[code]/page.tsx`

```tsx
import { prisma } from '@/lib/prisma';
import { notFound } from 'next/navigation';

export default async function ProductDetailPage({
  params,
}: {
  params: { code: string };
}) {
  const product = await prisma.product.findUnique({
    where: { code: params.code },
  });

  if (!product) {
    notFound();
  }

  return (
    <div>
      {/* 产品详情 */}
    </div>
  );
}
```

## 添加API路由

创建文件: `src/app/api/products/route.ts`

```typescript
import { NextResponse } from 'next/server';
import { prisma } from '@/lib/prisma';

export async function GET(request: Request) {
  const { searchParams } = new URL(request.url);
  const category = searchParams.get('category');

  const products = await prisma.product.findMany({
    where: category ? { category } : undefined,
  });

  return NextResponse.json(products);
}
```

## 多语言翻译

### 添加新的翻译键

1. 编辑 `src/messages/zh.json`:
```json
{
  "products": {
    "title": "产品中心",
    "filter": "筛选"
  }
}
```

2. 编辑 `src/messages/en.json`:
```json
{
  "products": {
    "title": "Products",
    "filter": "Filter"
  }
}
```

### 在组件中使用

```tsx
const t = useTranslations('products');
return <h1>{t('title')}</h1>;
```

## 样式开发

### 使用预定义样式类

```tsx
<div className="container-custom section-padding">
  <h1 className="heading-1">标题</h1>
  <button className="btn-primary">按钮</button>
</div>
```

### 自定义样式

```tsx
<div className="bg-primary text-white p-6 rounded-lg hover:bg-primary-dark transition-colors">
  内容
</div>
```

## 数据库操作

### 查询数据

```typescript
// 查询所有
const products = await prisma.product.findMany();

// 条件查询
const newProducts = await prisma.product.findMany({
  where: { isNew: true },
  orderBy: { createdAt: 'desc' },
  take: 10,
});

// 查询单个
const product = await prisma.product.findUnique({
  where: { code: 'G5-001' },
});
```

### 创建数据

```typescript
const product = await prisma.product.create({
  data: {
    code: 'G5-002',
    nameZh: '产品名称',
    nameEn: 'Product Name',
    category: 'category-slug',
  },
});
```

### 更新数据

```typescript
await prisma.product.update({
  where: { id: 'product-id' },
  data: { isNew: false },
});
```

### 删除数据

```typescript
await prisma.product.delete({
  where: { id: 'product-id' },
});
```

## 常见问题

### Q: 如何修改数据库结构?

A: 
1. 编辑 `prisma/schema.prisma`
2. 运行 `npm run db:push`

### Q: 如何重置数据库?

A:
1. 删除 `prisma/dev.db` 文件
2. 运行 `1_初始化数据库.bat`

### Q: 如何添加新的组件?

A:
1. 在 `src/components/` 创建新文件
2. 导出组件
3. 在需要的页面中导入使用

### Q: 如何部署到生产环境?

A:
1. 运行 `4_构建生产版本.bat`
2. 配置生产环境的数据库
3. 运行 `5_启动生产服务器.bat`

## 推荐的开发工具

- **VS Code**: 代码编辑器
- **Prisma Extension**: VS Code 的 Prisma 插件
- **Tailwind CSS IntelliSense**: TailwindCSS 智能提示
- **ESLint**: 代码检查
- **Prettier**: 代码格式化

## 下一步开发任务

1. [ ] 完善产品列表页面
2. [ ] 实现产品搜索功能
3. [ ] 创建后台管理界面
4. [ ] 添加用户认证
5. [ ] 实现图片上传
6. [ ] 优化SEO
7. [ ] 添加单元测试
8. [ ] 性能优化
